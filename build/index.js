!function(){"use strict";var e,r={680:function(e,r,t){var n=window.wp.blocks,i=t(893),s=window.wp.blockEditor,o=t(196),l=window.wp.components,c=window.wp.i18n;function a({placeholder:e,value:r,loadOptions:t,onChange:n}){const[s,a]=(0,o.useState)(!1),[u,d]=(0,o.useState)(!1),[f,m]=(0,o.useState)(),v=function(e){const r=o.useRef(null),t=o.useRef(e);return o.useLayoutEffect((()=>{t.current=e})),o.useEffect((()=>{const e=e=>{const n=r.current;n&&!n.contains(e.target)&&t.current(e)};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),()=>{document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[]),r}((()=>{a(!1)}));return(0,o.useEffect)((()=>{t&&(d(!0),t((e=>{m(e),d(!1)})))}),[t]),(0,i.jsxs)("div",{className:"trv-selector-container",children:[(0,i.jsxs)("div",{className:"trv-selector-control "+(s?"focused":""),onClick:()=>{a(!s)},children:[(0,i.jsx)("div",{className:"control-value",children:r&&""!==r.label?(0,i.jsx)("div",{className:"single-value",children:r.label}):(0,i.jsx)("div",{className:"placeholder",children:e})}),(0,i.jsx)("div",{className:"indicator"})]}),s&&(0,i.jsxs)("div",{className:"menu-container",ref:v,children:[u&&(0,i.jsx)(l.Spinner,{}),0==f?.length?(0,i.jsx)("div",{className:"no-results",onClick:()=>{a(!1)},children:(0,c.__)("There are no forms created yet.","truvisibility-platform")}):(0,i.jsx)("div",{className:"menu-list",children:((e=[])=>e.map(((e,t)=>{const s=`select-item-${t}`;return(0,i.jsx)("div",{className:"select-item "+(r&&e.value===r.value?"selected":""),id:s,onClick:()=>{n(e),a(!1)},children:e.label})})))(f)})]})]})}const{pluginPath:u,accessToken:d,adminUrl:f,rootUrl:m,title:v,apiUrl:p,isConnected:h,apiNonce:x,formsScript:b,language:j}=window.trv_config;class w{constructor(e,r){this.value=e,this.label=r}}const g=e=>new w(e.id,e.title);function _({attributes:e,setAttributes:r}){const{formId:t,formName:n}=e,[s,l]=(0,o.useState)(null);return(0,i.jsxs)("div",{className:"form-block-settings",children:[(0,i.jsxs)("div",{className:"form-block-header",children:[(0,i.jsx)("div",{className:"logo_img",children:(0,i.jsx)("a",{href:"https://forms.truvisibility.com/",target:"_blank",title:(0,c.__)("TruVISIBILITY Forms","truvisibility-platform"),children:(0,i.jsx)("img",{alt:"Forms",src:`${u}assets/images/forms.svg`})})}),(0,i.jsx)("div",{className:"logo_title",children:(0,c.__)("TruVISIBILITY Forms","truvisibility-platform")})]}),s?(0,i.jsx)("div",{className:"forms-selector-error",children:s}):(0,i.jsx)(a,{placeholder:(0,c.__)("Select A Form...","truvisibility-platform"),value:new w(t,n),loadOptions:e=>{window.trvFormOptions?e(window.trvFormOptions):wp.apiFetch({path:"truvisibility/v1/forms"}).then((r=>{window.trvFormOptions=[...r.map(g)],e(window.trvFormOptions)})).catch((e=>{l(e)}))},onChange:e=>{r({formId:e.value,formName:e.label})}})]})}var y=window.jQuery,N=t.n(y);function I({formId:e}){const r=(0,o.useRef)(null),[t,n]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{if(n(!0),TruForms){if(r.current){r.current.innerHTML="";const t=document.createElement("script");t.innerHTML=`TruForms.createApp("tfb-${e}");`,r.current.appendChild(t)}n(!1)}else N().getScript(b).done((()=>{if(r.current){r.current.innerHTML="";const t=document.createElement("script");t.innerHTML=`TruForms.createApp("tfb-${e}");`,r.current.appendChild(t)}n(!1)})).fail((e=>{console.log(e),n(!1)}))}),[e,r]),(0,i.jsxs)("div",{className:"form-block-preview",children:[(0,i.jsx)("div",{"tru-forms-app-id":"tfb-"+e}),(0,i.jsx)("div",{ref:r}),t&&(0,i.jsx)("div",{className:"spinner-container",children:(0,i.jsx)(l.Spinner,{})})]})}function k(){const e=(0,s.useBlockProps)();return(0,i.jsx)("div",{...e,children:(0,i.jsxs)("div",{className:"form-block-error",children:[(0,i.jsxs)("div",{className:"logo-container",children:[(0,i.jsx)("img",{alt:"",src:`${u}assets/images/logo.svg`,className:"logo-img"}),(0,i.jsx)("span",{className:"logo_title",children:(0,c.__)("TruVISIBILITY","truvisibility-platform")})]}),(0,i.jsxs)("div",{className:"error-container",children:[(0,i.jsx)("div",{className:"error-message",children:(0,c.__)("Your TruVISIBILITY plugin isnâ€™t connected","truvisibility-platform")}),(0,i.jsx)("div",{className:"error-description",children:(0,c.__)("Please login to your account and connect your TruVISIBILITY plugin.","truvisibility-platform")})]}),(0,i.jsx)("button",{className:"connect-button",onClick:()=>{window.location.href=`${f}admin.php?page=truvisibility-platform`},children:(0,c.__)("Connect Plugin","truvisibility-platform")})]})})}var C=window.wp.element;(0,n.registerBlockType)("truvisibility-platform/form-block",{icon:function(){return(0,i.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M21 12C21 16.9706 16.9706 21 12 21C10.3217 21 8.75078 20.5406 7.40598 19.7408L3 20.9997L4.2589 16.5935C3.45924 15.2488 3 13.678 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12ZM6.96 12C6.96 14.7835 9.21649 17.04 12 17.04C14.7835 17.04 17.04 14.7835 17.04 12C17.04 9.21649 14.7835 6.96 12 6.96C9.21649 6.96 6.96 9.21649 6.96 12ZM14.0002 12.0003C14.0002 13.1049 13.1047 14.0003 12.0002 14.0003C10.8956 14.0003 10.0002 13.1049 10.0002 12.0003C10.0002 10.8958 10.8956 10.0003 12.0002 10.0003C13.1047 10.0003 14.0002 10.8958 14.0002 12.0003Z"})})},attributes:{formId:{type:"string",default:""},formName:{type:"string",default:""}},edit:function(e){const{attributes:r,isSelected:t}=e,n=(0,s.useBlockProps)();return"1"===h?(0,i.jsx)("div",{...n,children:(0,i.jsxs)("div",{className:"form-block-edit-content",children:[t||!r.formId?(0,i.jsx)(_,{...e}):(0,i.jsx)(i.Fragment,{}),r.formId&&(0,i.jsx)(I,{formId:r.formId})]})}):(0,i.jsx)(k,{})},save:function({attributes:e}){const{formId:r}=e;return r?(0,i.jsx)(C.RawHTML,{...s.useBlockProps.save(),children:`[truvisibility type="form" id="${r}"]`}):(0,i.jsx)(i.Fragment,{})}})},251:function(e,r,t){var n=t(196),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,l=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function a(e,r,t){var n,s={},a=null,u=null;for(n in void 0!==t&&(a=""+t),void 0!==r.key&&(a=""+r.key),void 0!==r.ref&&(u=r.ref),r)o.call(r,n)&&!c.hasOwnProperty(n)&&(s[n]=r[n]);if(e&&e.defaultProps)for(n in r=e.defaultProps)void 0===s[n]&&(s[n]=r[n]);return{$$typeof:i,type:e,key:a,ref:u,props:s,_owner:l.current}}r.Fragment=s,r.jsx=a,r.jsxs=a},893:function(e,r,t){e.exports=t(251)},196:function(e){e.exports=window.React}},t={};function n(e){var i=t[e];if(void 0!==i)return i.exports;var s=t[e]={exports:{}};return r[e](s,s.exports,n),s.exports}n.m=r,e=[],n.O=function(r,t,i,s){if(!t){var o=1/0;for(u=0;u<e.length;u++){t=e[u][0],i=e[u][1],s=e[u][2];for(var l=!0,c=0;c<t.length;c++)(!1&s||o>=s)&&Object.keys(n.O).every((function(e){return n.O[e](t[c])}))?t.splice(c--,1):(l=!1,s<o&&(o=s));if(l){e.splice(u--,1);var a=i();void 0!==a&&(r=a)}}return r}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[t,i,s]},n.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(r,{a:r}),r},n.d=function(e,r){for(var t in r)n.o(r,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},n.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},function(){var e={826:0,431:0};n.O.j=function(r){return 0===e[r]};var r=function(r,t){var i,s,o=t[0],l=t[1],c=t[2],a=0;if(o.some((function(r){return 0!==e[r]}))){for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(c)var u=c(n)}for(r&&r(t);a<o.length;a++)s=o[a],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(u)},t=self.webpackChunktruvisibility_platform=self.webpackChunktruvisibility_platform||[];t.forEach(r.bind(null,0)),t.push=r.bind(null,t.push.bind(t))}();var i=n.O(void 0,[431],(function(){return n(680)}));i=n.O(i)}();